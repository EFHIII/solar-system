var w,h,points=[],allBodies=[],bodies=[],nbody={},dir,t=255,pts=255/10;
var G=6.67408e-20;
var presets=[
  {name:"Minimal",focus:0,bodies:[0,1,2,3,4,5,6,7,10,13,16]},
  {name:"Named bodies",focus:0,bodies:[]},
  {name:">1e20 kg bodies",focus:0,bodies:[]},
  {name:">1e18 kg bodies",focus:0,bodies:[]},
  {name:"All available bodies",focus:0,bodies:[]},
  {name:"Inner solar system",focus:0,bodies:[2,3,4,16]},
  {name:"Outer solar system",focus:0,bodies:[0,1,2,5,6,7,10,13]},
  {name:"20-- Calaogued",focus:0,bodies:[0,1,2,3,4,5,6,7,10,13,16]},
  {name:"Jupiter's moons",focus:1,bodies:[0,1,2,3,4,5,6,7,10,13,16]},//jupiter
  {name:"Saturn's moons",focus:2,bodies:[0,1,2,3,4,5,6,7,10,13,16]},//saturn
  {name:"Uranus' moons",focus:4,bodies:[0,1,2,3,4,5,6,7,10,13,16]},//Uranus
  {name:"Neptune's moons",focus:3,bodies:[0,1,2,3,4,5,6,7,10,13,16]},//Neptune
  {name:"Pluto's moons",focus:10,bodies:[0,1,2,3,4,5,6,7,10,13,16]},//Pluto
];
var onPreset=2;
function setup() {
  createCanvas(windowWidth, windowHeight);
  frameRate(60);
  w=width;
  h=height;
  points=[];
  //body(name,color,radius,mass,x,y,z,vx,vy,vz)
  allBodies=[
      new body("Sun",color(255,255,200),695700,1988500e24,-1.068000648301820E+06, -4.176802125684930E+05,  3.084467020687090E+04,  9.305300847631915E-03, -1.283176670344807E-02, -1.631528028381386E-04),
      new body("Jupiter",color(140,140,100),69911,1898.13e24,5.978411588543636E+08,  4.387049129308410E+08, -1.520170148446965E+07, -7.892632330758821E+00,  1.115034520921672E+01,  1.305097532924950E-01),
      new body("Saturn",color(230,170,125),58232,5.6834e26,9.576383364778246E+08,  9.821475307691972E+08, -5.518981181329101E+07, -7.419580383283150E+00,  6.725982472902061E+00,  1.775012040472701E-01),
      new body("Uranus",color(184,215,242),25362,86.813e24,2.157706702828831E+09, -2.055242911807622E+09, -3.559264256520975E+07,  4.646953712646178E+00,  4.614361110490073E+00, -4.301340943493193E-02),
      new body("Neptune",color(64,151,227),24624,102.413e24,2.513785502564252E+09, -3.739265198070839E+09,  1.907031307341528E+07,  4.475107876260091E+00,  3.062850727543816E+00, -1.667289047123263E-01),
      new body("Earth",color(83,139,145),6371.01,5.97219e24,-2.627892928682480E+07,  1.445102393586391E+08,  3.022818135935813E+04, -2.983052803283506E+01, -5.220465685407924E+00, -1.014621798034465E-04),
      new body("Venus",color(242,218,196),6051.84,48.685e23,-1.085735509178141E+08, -3.784200933160055E+06,  6.190064472977990E+06,  8.984651054838754E-01, -3.517203950794635E+01, -5.320225582712421E-01),
      new body("Mars",color(210,160,85),3389.92,6.4171e23,2.069270543147017E+08, -3.560689745239088E+06, -5.147936537447235E+06,  1.304308833322233E+00,  2.628158890420931E+01,  5.188465740839767E-01),
      new body("Ganymede",color(200,200,180),2634.1,1482e20,5.968054281104712E+08,  4.384332667767492E+08, -1.522334823708719E+07, -5.113764653294198E+00,  6.421550571838693E-01, -2.272620736444524E-01),
      new body("Titan",color(230,230,140),2575.5,13455.3e19,9.568613822948571E+08,  9.830500946779513E+08, -5.557947771220148E+07, -1.169879712511013E+01,  3.942276827684097E+00,  2.034192806410284E+00),
      new body("Mercury",color(100),2439.7,3.302e23,-2.212062175862221E+07, -6.682431829610253E+07, -3.461601353176080E+06,  3.666229236478603E+01, -1.230266986781422E+01, -4.368336051784789E+00),

      new body("Callisto",color(186,148,143),2403,1076e20,5.985071536953070E+08,  4.404607788863851E+08, -1.513558474691284E+07, -1.555591399528942E+01,  1.411983398700690E+01,  1.260807701802191E-01),
      new body("Io",color(184, 180, 68),1821.3,893.3e20,5.978859511926628E+08,  4.382846342872659E+08, -1.521595181406739E+07,  9.292667104479822E+00,  1.302536635856758E+01,  4.581573986898553E-01),
      new body("Moon",color(230),1737.53,7.349e22,-2.659657952880802E+07,  1.442683561835989E+08,  6.678400538153946E+04, -2.926974096953943E+01, -6.020397947517719E+00, -1.740793458484102E-03),
      new body("Europa",color(237,202,145),1565,479.7e20,5.972090771817015E+08,  4.389225841531876E+08, -1.520474443357745E+07, -1.226471792801061E+01, -1.925435825460625E+00, -2.954047642836232E-01),
      new body("Triton",color(230),1352.6,214.7e20,2.513485302886966E+09, -3.739285451508122E+09,  1.925838278513193E+07,  5.752030722532645E+00,  6.502688633888694E+00,  2.243347569134719E+00),
      new body("Pluto",color(230),1188.3,1.307e22,-1.478626340724678E+09, -4.182878118662979E+09,  8.753002592760717E+08,  5.271230989790396E+00, -2.661751411789654E+00, -1.242036206632027E+00),
      new body("Eris",color(230),1163,16.7e21,1.322243110870202E+10,  4.601936414763955E+09, -3.903714549949867E+09, -3.432740932761868E-01,  1.676320271701464E+00,  1.504411524027339E+00),
      new body("Haumea",color(230),798,4.006e21,-6.881091040497869E+09, -7.662747017766662E+08,  3.348851375450475E+09,  8.350739808477889E-01, -3.584005976136049E+00,  6.370596374245071E-01),
      new body("Titania",color(230),788.9,35.27e20,2.157796534835606E+09, -2.055321557264454E+09, -3.601157707079530E+07,  1.162364712566031E+00,  5.256539569270866E+00, -9.184467829991749E-01),
      new body("Rhea",color(230),764.5,230.9e19,9.572178737883351E+08,  9.824452301918745E+08, -5.530361390037769E+07, -1.248447479895971E+01,  9.420143885002257E-01,  3.746822337280829E+00),
      new body("Oberon",color(230),761.4,30.14e20,2.157185896153312E+09, -2.055165500677734E+09, -3.584412574793208E+07,  3.387995817974851E+00,  5.285396465069921E+00,  2.766783649934617E+00),
      new body("Iapetus",color(230),734.5,180.59e19,9.547036831226707E+08,  9.802383132558823E+08, -5.414901508745444E+07, -5.596413867486061E+00,  4.130576027635693E+00,  4.256133128317086E-01),
      new body("Makemake",color(230),715,4.4e21,-6.520228832179061E+09,  1.716867947066155E+09,  3.727707169877112E+09, -1.217985017892816E+00, -3.661226367968196E+00,  2.919151551813599E-01),
      new body("2007 OR10",color(230),615,1.75e21,1.051059642726635E+10, -6.616661330332912E+09, -1.162266184886216E+09,  2.349978783028555E+00,  1.098909323924172E+00,  1.153392524738409E+00),
      new body("Charon",color(230),605,1.53e21,-1.478626381629830E+09, -4.182888525791242E+09,  8.752836534670407E+08,  5.107250690301193E+00, -2.789785042147744E+00, -1.161429450701579E+00),
      new body("Umbriel",color(230),584.7,11.72e21,2.157944697488786E+09, -2.055308981761433E+09, -3.569337395390940E+07,  2.778973864036194E+00,  4.435888756698066E+00, -4.302014902970738E+00),
      new body("Ariel",color(230),579,13.53e20,2.157823020849339E+09, -2.055247448263577E+09, -3.544134626099598E+07,  8.861434274365276E+00,  3.235074605340979E+00, -3.313339122257013E+00),
      new body("Dione",color(230),562.5,109.572e19,9.574596345892345E+08,  9.818603374734230E+08, -5.502202388721240E+07,  1.379410834159040E+00,  2.173907719118488E+00,  1.704792595357602E+00),
      new body("Quaoar",color(230),560.5,1.4e21,-2.509470447883734E+09, -5.959053288257437E+09,  7.718306161747596E+08,  4.218945248645490E+00, -1.556219457039755E+00,  3.075951452229478E-01),
      new body("Tethys",color(230),536.3,61.76e19,9.574216765313864E+08,  9.819793131971315E+08, -5.508198482326096E+07,  1.977556491001859E-01, -1.088632517188188E+00,  3.294225170457716E+00),
      new body("Sedna",color(230),497.5,0.5e21,9.266929576684046E+09,  9.555428836711725E+09, -2.780925755359698E+09, -3.917782619972957E+00,  1.548504271019760E+00,  2.157590502721703E-01),
      new body("Ceres",color(230),469.7,0.939e21,-3.567414773716888E+08,  1.193768644542298E+08,  6.927036595980538E+07, -6.233326524696016E+00, -1.832962558073848E+01,  5.850328029221981E-01),
      new body("2002 MS4",color(230),467,0.6e21,-1.051114894176661E+09, -6.868462802075814E+09,  1.573507020527465E+09,  3.912121522967744E+00, -2.679712568856799E-01,  8.039998226998822E-01),
      new body("Orcus",color(230),458,0.641e21,-5.257718421760192E+09,  4.293404770356354E+09, -2.012058118897372E+09, -2.458050117854932E+00, -2.842594398548450E+00, -8.957229626014243E-01),
      new body("Salacia",color(230),446.5,0.4922e21,5.609841069520637E+09, -2.248704875097790E+09,  2.276133733819829E+09,  1.705842654869924E+00,  3.999028313911337E+00,  1.056396875231174E+00),



      new body("2002 AW197",color(230),384,3e20,-4.623643030500104E+09,  5.371081917027529E+09, -7.358271230232749E+08, -2.484406078975067E+00, -3.097489332928160E+00, -1.646888284501735E+00),
      new body("Varda",color(230),378,2.664e20,-3.532699879001182E+09, -5.995807801577412E+09,  2.257630186582763E+09,  3.819412409029667E+00, -1.378315941872443E+00,  6.494045047756599E-01),
      new body("2013 FY27",color(230),370,2.5e20,-1.089182320790220E+10,  4.132655031609718E+09, -3.548288013727268E+09, -9.187469238252930E-01, -2.066443009611235E+00,  1.264348550024358E+00),
      new body("2004 GV9",color(230),340,2e20,-5.159043144487278E+09, -2.079500098364438E+09, -1.685647262047249E+09,  1.372559490443248E+00, -4.621886679943867E+00,  1.142165567482779E+00),
      new body("2005 RN43",color(230),339.5,3.7e20,4.420565644036809E+09, -3.917176333821123E+09,  1.547454759297676E+09,  3.188236542501174E+00,  3.307795589471165E+00, -1.011829429957856E+00),
      new body("2015 RR245",color(230),335,3.5e20,1.070361036666907E+10, -4.872129574520273E+08,  8.019202172294115E+08, -1.980222824956060E+00,  3.118092988779863E+00, -4.896854713760905E-01),
      new body("Varuna",color(230),334,3.7e20,-9.665633213602618E+08,  6.357892485206325E+09,  4.668086375762510E+07, -4.320901995236902E+00, -4.188827021514273E-01,  1.341110633715027E+00),
      new body("2002 UX25",color(230),332.5,1.25e20,6.031696646648212E+09,  2.256444523904770E+09,  1.631460742787498E+08, -2.044327318072285E+00,  3.742805772785900E+00, -1.500946152200333E+00),
      new body("Gǃkúnǁʼhòmdímà",color(230),319,1.361e20,4.769446794716092E+09,  4.738959863579417E+09, -2.897732607909683E+09, -4.390501369386377E+00,  2.054169228587328E+00,  8.430282007975003E-01),
      new body("2014 UZ224",color(230),317.5,1.2e20,1.071035764265199E+10,  7.746236018163155E+09, -6.645728074021093E+09, -2.892671031001480E+00,  8.605997928958760E-01,  8.169423350928786E-01),
      new body("Ixion",color(230),308.5,1e20,-2.864000889730670E+09, -5.854295050765127E+09,  2.872862999210763E+08,  3.917163691577946E+00, -9.297382036045891E-01, -1.429096297896840E+00),
      new body("Chaos",color(230),307.5,1e20,3.351552260031047E+09,  5.377370234101646E+09,  1.899966413464544E+08, -4.127243490174473E+00,  2.129176405077815E+00,  9.657884683336433E-01),
      new body("2014 EZ51",color(230),307.5,1e20,-7.592736173777466E+07, -3.088593764151649E+08, -1.052289828633713E+08,  1.779437646158409E+01, -3.955897615567084E+00,  1.055837379026465E+00),
      new body("2010 RF43",color(230),305.5,1e20,5.617509957002004E+09, -3.587552461628972E+09, -3.344444841936346E+09,  3.304243428677758E+00,  2.539785633139368E+00,  5.226708062007249E-01),
      new body("2007 JJ43",color(230),305,1e20,-4.306689672339117E+09, -4.630706357294450E+09, -9.626054361219943E+08,  3.758869592773681E+00, -2.880857993794569E+00,  7.751003964489027E-01),
      new body("2006 QH181",color(230),303.5,1e20,5.603710415188473E+09,  1.045456048109368E+10, -8.578174616024928E+08, -1.703436382796238E+00,  2.366403326050643E+00,  7.958781195426481E-01),
      new body("2002 TC302",color(230),295.5,1e20,6.586382299965587E+09,  3.225041543785052E+09,  2.004056998647425E+08, -2.715636935181097E+00,  2.610470547395236E+00,  2.444221425472016E+00),

      //start of new bodies
      new body("2002 XW93",color(230),293.5,1e20,2.096506484434389E+09,  6.045930435231742E+09,  6.673575779965222E+08, -3.536718992803467E+00,  2.023048712248321E+00,  1.014437335219193E+00),
      new body("2010 KZ39",color(230),287,1e20,-3.731627036193037E+09, -5.925994561448660E+09, -2.764910118602641E+08,  3.386529125010902E+00, -1.825827770662245E+00, -1.863225149097048E+00),
      new body("2010 JO179",color(230),287,1e20,-4.412276495606831E+09, -4.750683996232979E+09,  3.995879812716260E+09,  2.363363730440935E+00, -4.028921666868565E+00,  1.317138298296602E+00),
      new body("2014 WK509",color(230),287,1e20,5.506432988645153E+09,  6.244661404200438E+09,  2.858238502242827E+08, -3.212505102284594E+00,  1.833191157431160E+00,  9.027751755373228E-01),
      new body("2010 RE64",color(230),280.5,1e20,8.261324186155217E+09, -2.366843441678421E+09, -2.055245624843239E+09, -6.366149931447318E-01,  3.988175185183576E+00,  5.094480192919499E-01),
      new body("2014 AN55",color(230),280.5,1e20,-4.604520489972975E+09,  6.453551645878348E+09, -4.860655757157094E+08, -2.166635697885405E+00, -3.564439212979062E+00, -4.895531365188337E-01),
      new body("2013 FZ27",color(230),280,1e20,-6.243546588674171E+09,  4.395435153855407E+09, -1.221976031682627E+09, -1.458327697901826E+00, -3.662867065713473E+00, -5.896528517126107E-01),
      new body("2004 XR190",color(230),274.6,1e20,3.184898974544789E+09,  8.188145650874949E+09,  5.876945035152168E+08, -2.526274610602602E+00,  7.501731933098834E-01, -2.790252163883850E+00),
      new body("2002 XV93",color(230),274.6,1e20,2.363038461512556E+09,  5.549847649645795E+09,  1.055415173055200E+09, -4.371966799067384E+00,  1.155807299584315E+00,  5.941550061516122E-01),
      new body("2008 ST291",color(230),274.5,1e20,7.829510643486062E+09, -3.238958549973562E+08,  1.330803186570094E+09,  1.777349491325307E+00,  4.277728033078581E+00,  1.747037028078394E+00),
      new body("2004 XA192",color(230),274.5,1e20,1.676008864252333E+09,  4.016823388288875E+09,  3.375455050127046E+09, -5.022640190770566E+00,  1.881012947448511E+00, -7.891962448286491E-01),
      new body("2010 FX86",color(230),274.5,1e20,-5.885713675060222E+09, -2.578957654204353E+09, -2.884559728672365E+09,  2.143915236244155E+00, -3.742099968831699E+00, -3.912655020810447E-01),
      new body("2003 VS2",color(230),274.15,1e20,3.502182495384223E+09,  3.958392398164835E+09,  1.342890850949059E+09, -3.795957116953026E+00,  3.415928389780263E+00, -3.555958347439842E-01),
      new body("2003 UZ413",color(230),268,1e20,5.057214049585580E+09,  3.065589332547212E+09, -1.219912237745024E+09, -1.518482990299875E+00,  4.344148878390653E+00, -4.421860017473955E-01),
      new body("2014 YA50",color(230),268,1e20,-5.411406596529922E+09,  3.051285140329059E+09,  2.653455691075843E+09, -1.720076550095485E+00, -4.089008780502128E+00, -7.300069466641033E-01),
      new body("2014 FC69",color(230),266.5,1e20,-9.581727448769331E+09, -5.841541935200712E+09, -4.072868127565171E+09, -3.771824618946851E-02, -3.091488928702209E+00,  5.863121069855147E-01),
      new body("2017 OF69",color(230),266.5,1e20,1.516058666225243E+09, -6.589371749659661E+09,  1.480197033500875E+09,  3.704945752112571E+00,  1.435683341969435E+00,  2.904917562076103E-01),
      new body("2001 UR163",color(230),265.7,1e20,6.841937768389471E+09,  2.307908060958495E+09,  9.226656556522977E+07, -1.974612903775569E-01,  4.419712756175997E+00,  2.851547232022966E-02),

      new body("Vesta",color(230),262.7,2.59e20,-2.042799267816037E+08, -2.501607378458711E+08,  3.225031597895983E+07,  1.663991117442632E+01, -1.287265944282430E+01, -1.632163322094211E+00),
      new body("2005 RM43",color(230),262,1e20,3.953704241499448E+09,  2.874586985379556E+09, -2.012799882397389E+09, -3.250993984245397E+00,  5.074417572943229E+00,  2.036629562547816E+00),
      new body("Pallas",color(230),256,2.11e20,-1.260220792696972E+08,  2.472856041383860E+08, -1.609056608822669E+08, -2.033552561192339E+01, -7.106825589222365E+00,  6.581658973608368E+00),
      new body("2004 TY364",color(230),256,1e20,5.485105942207184E+09,  1.278549080174471E+09, -2.071607207253481E+09, -1.650541448832882E+00,  4.203534589651075E+00, -1.015301027872829E+00),
      new body("2010 VK201",color(230),252.5,1e20,5.279295001553101E+09,  3.657520961860017E+09, -3.008260081139580E+09, -2.451395493677158E+00,  3.133007600286282E+00, -1.042684240756264E+00),
      new body("2003 QX113",color(230),252.5,1e20,7.067598790274989E+09, -4.988961865144300E+09,  2.354781403501823E+08,  2.584086329090076E+00,  2.445429074871896E+00, -3.827500257266966E-01),
      new body("2011 FW62",color(230),251.5,1e20,-5.087617421181396E+09,  3.303928094380795E+09, -2.899355707655088E+09, -1.698540347980126E+00, -3.999730336660349E+00, -3.427102124665851E-01),
      new body("Enceladus",color(230),252.1,1.08e20,9.574006362037154E+08,  9.821521220152528E+08, -5.516914846193230E+07, -7.078612117217630E+00, -4.445379446346172E+00,  5.997799520773266E+00),
      new body("2018 VG18",color(230),250,0.9e20,5.851666970143058E+09,  1.671376506860885E+10, -6.275841238156691E+08, -6.840755142077803E-01,  2.110582763775273E+00, -8.818595077546016E-01),
      new body("2005 UQ513",color(230),249,0.8e20,6.809997728574036E+09,  5.691563243918557E+08,  2.761048518398819E+09, -8.592711321407835E-01,  3.768954142470121E+00,  7.841570418518602E-01),
      new body("2004 NT33",color(230),241.26,0.6e20,2.556579534351528E+09, -4.240851161852981E+09,  2.601723009659296E+09,  4.110689553859699E+00,  2.897992424774465E+00,  1.329175035652785E+00),
      new body("2014 UM33",color(230),239,0.5e20,6.400380264348993E+09,  2.291699158365415E+09,  1.277269320104166E+09, -1.725023824126775E+00,  3.690901599811573E+00, -1.085941373951629E+00),
      //new body("Vanth",color(230),237.5,0.4e20,),
      new body("Miranda",color(230),235.8,0.659e20,2.157829883706740E+09, -2.055264529732225E+09, -3.562720219149590E+07,  2.748843739570371E+00,  4.056752180693761E+00, -6.429115454735349E+00),
      new body("Dziewanna",color(230),235,0.5e20,-6.223039379240178E+09, -1.356425061328657E+09, -1.583301593077637E+09,  3.473909877197737E+00, -3.644183769247090E+00, -1.530389340285210E+00),
      new body("2015 AM281",color(230),234,0.5e20,-2.633482586697318E+09,  5.678607081231899E+09,  3.148433601333058E+09, -3.821080039640447E+00, -2.645749008824350E+00, -5.121747534080474E-01),
      new body("2005 TB190",color(230),232,0.5e20,6.074759585739771E+09, -3.214994191209982E+09,  1.625280623108439E+09,  2.102724339948600E+00,  4.151177792684019E+00, -2.059414742570502E+00),
      new body("1999 DE9",color(230),230.5,0.5e20,-4.524039243386426E+09,  2.228690408263989E+09, -1.263512368453325E+08, -3.462657426973325E+00, -4.900865416960289E+00, -8.023589454996687E-01),
      new body("2003 FY128",color(230),230,0.5e20,-5.601046553799332E+09,  2.770611023947527E+08, -3.105810634967825E+08, -5.999835791052586E-01, -5.272592080808332E+00, -1.083258826681658E+00),
      new body("2000 YW134",color(230),227.5,0.5e20,-2.764884163592756E+09,  5.721197006792037E+09, -4.432219644498320E+08, -4.651555257140498E+00, -1.419918744169472E+00,  1.646422920054951E+00),
      new body("2012 VP113",color(230),225,0.5e20,8.738337623262732E+09,  7.514916305641093E+09, -3.946680984942415E+09, -2.120297768646732E+00,  3.616426048294426E+00,  9.236189642657067E-01),
      new body("2002 VR128",color(230),224.25,0.5e20,4.547333155198238E+09,  2.499562290879478E+09,  1.289161473226281E+08, -1.346004202507704E+00,  5.021518345705571E+00,  1.284545701811674E+00),
      new body("2011 GM27",color(230),223,0.5e20,-6.101000502998017E+09,  1.517328197702485E+09, -1.455227400874471E+09, -1.207417221573953E+00, -4.402093667872955E+00, -4.599184710093507E-02),
      new body("2010 TJ",color(230),221.5,0.5e20,4.637109862373491E+09,  3.497448897610476E+08, -3.747205993825193E+09, -3.321108448101902E-01,  5.498355529066250E+00,  1.672572633851170E-01),
      new body("Hygiea",color(230),217,0.832e20,-3.566791123555961E+08, -2.186949613276204E+08, -2.664193888707866E+07,  1.056015440789594E+01, -1.552534425518024E+01,  4.423371211071823E-01),
      new body("1999 CD158",color(230),210.13,0.5e20,-3.605308896027607E+09,  6.277541904466314E+09,  5.149809742391825E+07, -2.953792505001568E+00, -2.157099448575656E+00,  1.729187645406359E+00),
      new body("Proteus",color(230),210,0.44e20,2.513708568152246E+09, -3.739196871829654E+09,  1.912735750861931E+07, -5.928570367762918E-01, -2.631441412595419E+00, -1.742613662104077E-01),
      new body("2005 QU182",color(230),208,0.3e20,6.332839425064483E+09, -5.404464781544904E+08, -1.577289221410508E+09,  2.443090705081828E+00,  5.153746778922120E+00, -3.393119308743200E-01),
      new body("2002 KX14",color(230),207.5,0.3e20,-3.669647825011134E+09, -4.691210171233751E+09, -3.422411316430521E+07,  3.771408652848177E+00, -2.737869703847020E+00,  1.980625196387975E-02),
      new body("2001 QF298",color(230),204.1,0.3e20,6.137403378199894E+09, -1.626034300303576E+09, -4.450930727618432E+07,  1.364054582117479E+00,  3.828952536798698E+00, -1.667649283246180E+00),
      new body("2004 PF115",color(230),203.15,0.3e20,4.222500067527565E+09, -4.330174899510291E+09, -1.094641200826470E+09,  3.238197187554794E+00,  3.077215736278629E+00, -6.970796120347258E-01),
      new body("Huya",color(230),203,0.3e20,-4.246663628099085E+09, -1.321510017821988E+09,  5.772419744123391E+08,  2.719203368614251E+00, -5.259680344976079E+00,  1.291484921551503E+00),
      new body("2010 VZ98",color(230),200.67,0.3e20,6.195356913396181E+09,  1.567573443771121E+09, -4.908142266612960E+08, -3.737487664559215E+00,  4.658454850257042E+00,  9.266086756440917E-02),

      new body("2004 UX10",color(230),199,30e18,5.519529277170658E+09,  1.492413804489186E+09, -7.041753960300932E+08, -1.132788069415303E+00,  4.664508634333987E+00, -5.630528990072929E-01),
      new body("Mimas",color(230),198.2,37.49e18,9.575253747015799E+08,  9.822855103329567E+08, -5.525144481034631E+07, -1.857313754688082E+01, -5.997765277481617E-01,  4.659827813523060E+00),
      new body("1998 SN165",color(230),196.5,20e18,5.678676111359291E+09, -6.010611692557194E+08,  1.431765120502600E+08,  3.121335207232547E-01,  4.780325421337690E+00, -3.711075280831457E-01),
      //new body("Ilmare",color(230),180.5,20e18,),
      new body("Nereid",color(230),170,20e18,2.514699901835640E+09, -3.729941820890703E+09,  1.975148084305358E+07,  4.029273805307922E+00,  2.938140427551477E+00, -2.003976701207937E-01),
      new body("1996 TL66",color(230),169.5,20e18,4.069335266288664E+09,  3.305467307996799E+09, -5.351363766510415E+07, -3.763994371659609E+00,  4.390417027093344E+00, -2.569101018240113E+00),
      new body("2002 WC19",color(230),169,77e18,3.031848363221148E+09,  5.943053143123610E+09, -7.856126292477858E+08, -4.424995361496960E+00,  1.018901661739723E+00,  6.177689841774832E-01),
      new body("2010 TY53",color(230),164.5,20e18,5.443217575241256E+09, -4.229002722596735E+08, -2.031201181174547E+09, -1.973794979761968E+00,  4.352426144065999E+00,  1.044765064601607E-01),
      //new body("Hi'laka",color(230),160,17.9e18,),
      new body("Interamnia",color(230),153.157,32.8e18,-2.046493633160393E+08, -4.443127566736480E+08, -8.797687438225198E+07,  1.421701055826986E+01, -5.214491902669188E+00,  4.054932700783230E+00),
      new body("52 Europa",color(230),151.959,23.8e18,-4.110913345763111E+08,  1.304859970014944E+08,  3.096290344493344E+07, -6.594452141013204E+00, -1.677521413374912E+01,  2.056271412742261E+00),
      new body("2004 EW95",color(230),145.5,15e18,-4.312985555243062E+09, -2.073689775106381E+08,  9.453005048436000E+08,  8.670324024475106E-01, -5.328484423426231E+00, -2.902494886391357E+00),
      new body("Davida",color(230),145.218,33.8e18,-3.993687475933223E+07, -5.569505181949611E+08,  5.910918590795830E+07,  1.338727266959464E+01, -1.398958719347511E+00, -3.518680518820542E+00),
      new body("1995 SN55",color(230),145,10e18,5.551166370461778E+09,  1.757274539733732E+09, -4.043570861582293E+08, -1.193367648691900E+00,  2.529589776014540E+00, -1.197047895303291E-01),
      new body("Sylvia",color(230),143,14.78e18,-2.266427929108911E+06,  5.313371931674089E+08,  2.948978985062677E+07, -1.531007486411041E+01,  1.000408894825274E+00,  2.870886104499530E+00),
      //new body("Actaea",color(230),143,5e18,),
      new body("Hyperion",color(230),138.6,5.62e18,9.580232393115659E+08,  9.833495048416483E+08, -5.583506697858655E+07, -1.228079145055907E+01,  8.747230441587554E+00, -3.335004366038516E-01),
      new body("Lempo",color(230),136,5e18,4.674137004740035E+09, -2.763601994748310E+08, -6.810477289660912E+08, -3.078181124442243E-01,  5.790943536218379E+00, -6.092962102514665E-02),
      new body("1998 SM165",color(230),134,6.87e18,5.028231813191072E+09,  1.111700564364509E+09, -2.005068159674793E+08,  2.230436909200729E-01,  5.576977604396783E+00, -1.333589045562954E+00),
      new body("Euphrosyne",color(230),133.54,12.7e18,4.464791552415121E+08, -4.936926354462713E+07, -1.357986465801846E+08, -3.146454824935206E-01,  1.543167572409535E+01,  6.618900058134818E+00),
      new body("Chariklo",color(230),130.175,5e18,-1.662827310084127E+09,  1.041858438601538E+09, -3.912362294160701E+08, -3.243445207696744E+00, -7.597735506455647E+00, -2.875344037642507E+00),
      new body("Eunomia",color(230),128.205,31.4e18,-3.877496503200751E+08,  1.743586482152735E+08, -5.919994636941572E+07, -8.980032713701350E+00, -1.397239777225530E+01, -2.872548618017229E+00),
      new body("2005 RR43",color(230),126,5e18,4.062356552965645E+09,  3.365246479483756E+09, -2.068125157067207E+09, -2.376504076268546E+00,  4.310821762670610E+00,  1.456874284108392E+00),
      //new body("Hiisi",color(230),125.5,5e18,),
      new body("Hektor",color(230),125,7.9e18,-3.179690462035307E+08,  6.742608973709624E+08,  1.812056702730121E+08, -1.190513972910873E+01, -5.123044352088147E+00, -2.765729017260080E+00),
      new body("Sila-Nunam",color(230),243.5,10.8e18,-3.034341414870669E+09,  5.772500515619108E+09,  2.951819975377417E+07, -3.985865515585939E+00, -2.140567637140314E+00, -1.763869100265776E-01),
      new body("2007 RW10",color(230),123.5,5e18,3.298707069983729E+09, -8.828384241325582E+08,  9.335610700667305E+08,  3.688984102272743E+00,  4.741211776854710E+00, -3.101231761818438E+00),
      new body("Juno",color(230),123.298,27.3e18,5.577493392056473E+07, -4.527661867874105E+08,  1.004303442380650E+08,  1.457661195777628E+01,  4.595985333176279E+00, -1.618387785253044E+00),
      new body("Altjira",color(230),123,5e18,4.249605515657474E+09,  5.201356960713114E+09,  4.604932328869579E+08, -3.243879832222080E+00,  2.965832324587723E+00,  2.793365794762417E-01),
      new body("Cybele",color(230),118.63,13.6e18,-3.889731659447211E+08,  3.774095015573105E+08, -1.149803750606082E+07, -9.602750314143838E+00, -1.178092283092790E+01,  9.094180584809473E-01),
      //new body("Nunam",color(230),118,5e18,),
      new body("2001 QC298",color(230),117.5,11.88e18,5.500374777930482E+09, -2.563925065721082E+09,  1.635187727697337E+07,  1.770976585931826E+00,  3.886245621876530E+00,  2.522373272770868E+00),
      new body("Psyche",color(230),116.667,24.1e18,3.731977570039152E+08, -8.480478677805817E+07, -5.971499493550178E+06,  3.044266159188670E+00,  1.942381057186446E+01, -9.949240115567921E-01),
      new body("Patientia",color(230),112.86,10.9e18,2.562488467761491E+08, -3.962640844905564E+08, -7.105641940937787E+07,  1.249114830727306E+01,  9.924904738906134E+00, -3.374354997521569E+00),
      new body("2014 NW65",color(230),112.5,5e18,1.572681992135998E+09, -4.316182560474501E+09,  1.647283708807877E+09,  3.022255923135539E+00,  2.619753069660017E+00, -1.291969230543740E-01),
      new body("Ceto",color(230),111.5,5.4e18,-3.310809373418166E+09, -4.523894720229825E+08,  3.731849016343247E+08, -2.312748279595204E+00, -7.415118276773390E+00,  3.143184453378466E+00),
      new body("2001 FP185",color(230),111.295,5e18,-5.148335834592738E+09,  2.703989478934207E+08, -1.268388013592645E+08,  1.311847386016629E-01, -5.914211986226220E+00,  3.524532072715270E+00),
      new body("Herculina",color(230),111.195,5e18,5.809087340377627E+07,  4.109684689454031E+08, -5.297335779421186E+07, -1.704111105158625E+01, -1.346954250288244E-01,  4.763382788731563E+00),
      //new body("S/2007 (148780) 1",color(230),110.5,5e18,),
      new body("Bamberga",color(230),110.346,10.3e18,7.830517499253431E+07, -3.434603708527074E+08, -4.887635447044279E+07,  1.728934212750675E+01,  1.024660336836105E+01,  3.500060038170404E+00),
      new body("Doris",color(230),108.237,6.12e18,3.226026804288444E+08, -3.612815466369936E+08,  4.392587058882016E+07,  1.141814894748936E+01,  1.131155891950678E+01, -1.206620064521521E+00),
      new body("Chiron",color(230),107.8,5e18,-5.294601718696632E+08, -1.365578072610041E+09,  1.132605337209635E+08,  8.615819086694847E+00, -6.344910810459444E+00,  1.185839804998645E+00),
      new body("Egeria",color(230),107.365,8.882e18,1.782309559286301E+08,  3.195776896314569E+08,  3.263033870552085E+07, -1.714933466983898E+01,  7.468379122588868E+00,  5.112870047272340E+00),
      new body("Iris",color(230),107,13.75e18,-1.753712653640213E+08,  2.700101255816662E+08, -2.116236271131140E+07, -1.976628668376327E+01, -7.571787779726376E+00, -1.754430273617314E+00),
      new body("Phoebe",color(230),106.56,8.298e18,9.459350565791291E+08,  9.793407488882908E+08, -5.385545608263814E+07, -8.101788823221849E+00,  8.416905154029292E+00,  2.811713143658281E-01),
      //new body("S/2012 (38628) 1",color(230),106.5,5e18,),
      new body("Deucalion",color(230),106,5e18,-5.936685207258048E+09, -2.776673255960451E+09,  1.866958253526366E+07,  2.162284482344798E+00, -3.964833735630354E+00, -2.677795357982116E-02),
      new body("2015 TH365",color(230),105.5,5e18,-4.985118307147985E+07, -4.724570584895265E+08,  6.573739385844196E+07,  1.542770456768785E+01, -3.763544079218591E-01,  9.891153340066862E-01),
      new body("Camilla",color(230),105.185,11.2e18,-1.826157074558011E+07,  4.751570529829722E+08, -8.329058355832037E+07, -1.709002907285199E+01, -1.174618562956397E+00,  5.641895076021918E-01),
      new body("Fortuna",color(230),103.45,8.6e18,-3.683478403461361E+08, -2.103246039439163E+08, -3.219180637490749E+05,  7.899854361897794E+00, -1.421851824670483E+01,  4.453619091850509E-01),
      new body("Thisbe",color(230),102.2,15.3e18,8.797639478037660E+07, -3.417516148344929E+08,  4.367535596882388E+06,  1.964913406774717E+01,  6.526321814290574E+00,  1.853717233298239E+00),
      new body("Eugenia",color(230),101.164,5.63e18,-3.631418207356247E+08,  1.640995358343076E+08,  6.117057134048335E+06, -6.185566517364676E+00, -1.729003224993241E+01,  2.078322581273203E+00),

      new body("Chicago",color(230),99.385,5.06e18,5.172384998370368E+08, -2.330728491171385E+08, -1.959617792352557E+07,  6.795674737742708E+00,  1.378096867517351E+01, -1.152666512893291E+00),
      new body("Bienor",color(230),99,5e18,2.554768653684367E+09, -1.405305717456850E+09, -1.277405194509076E+08,  2.372249488658649E+00,  5.191721932018947E+00,  2.159371959518768E+00),
      new body("Themis",color(230),97.756,5.89e18,4.288823195430593E+08, -3.110322026613216E+08, -6.672126417630106E+06,  8.660810826265770E+00,  1.189218712113257E+01,  6.006768842630983E-02),
      new body("Larissa",color(230),97,4.2e18,2.513821594693072E+09, -3.739201564020622E+09,  1.907867497764850E+07, -3.183457377720686E+00,  6.813567825268461E+00,  4.311332726681166E+00),
      new body("Ursula",color(230),96.815,8.45e18,2.517227905950929E+07,  4.732627149553370E+08,  1.271937811830696E+08, -1.573333624986889E+01,  2.712466628544904E+00, -1.062412573277822E+00),
      new body("Amphitrite",color(230),94.779,12.9e18,3.319021329327357E+07,  3.528397926729807E+08,  3.795173691062580E+07, -1.974087595848022E+01,  2.482993457845665E+00,  1.397640005614793E-01),
      new body("Daphne",color(230),94.5,6.31e18,2.699105847724354E+08, -2.614995726894914E+08,  7.151608553753437E+07,  1.676493836707773E+01,  9.129291344177386E+00, -2.718228499098816E+00),
      new body("Aurora",color(230),93.75,6.23e18,-4.011719238809068E+08, -3.128766676067467E+08, -4.092139272173308E+07,  9.197557877258841E+00, -1.238431642877112E+01, -1.796964188158212E+00),
      new body("Hermione",color(230),93.5,4.97e18,-4.719614647915632E+08, -3.340929534713566E+08,  4.753371281036687E+07,  8.910925144737652E+00, -1.091816806190891E+01, -1.547728092860687E+00),
      new body("Bertha",color(230),93.425,9.19e18,5.030254128708715E+08, -1.268963476416744E+06, -1.177757940384010E+08,  1.345075935428083E+00,  1.464026508593795E+01,  4.194934346854621E+00),
      new body("Hebe",color(230),92.59,13.9e18,2.949100239024338E+07,  3.121526217100459E+08, -6.732708769377071E+07, -2.040686492451345E+01,  6.178802396989453E+00,  2.310973473161323E+00),
      new body("Metis 9",color(230),91.506,8.39e18,-4.616330240357570E+07, -3.975755044457340E+08, -9.756742056731164E+06,  1.695811768119310E+01, -1.535854725260550E+00, -1.598977482934443E+00),
      new body("Elektra",color(230),90.326,6.6e18,-5.144828557427391E+08,  1.501268748351581E+08,  6.914497326259910E+07, -5.086491637325817E+00, -1.231005312511474E+01,  5.503394092072828E+00),
      new body("Loreley",color(230),90.042,19.1e18,2.117011865971183E+08,  4.330619212239861E+08,  8.205571308051673E+07, -1.374085166867844E+01,  8.198900292826114E+00, -1.414740405599885E+0),
      new body("Janus",color(230),89.5,1.898e18,9.575007788298309E+08,  9.822097807755896E+08, -5.520948297932124E+07, -1.399804309159293E+01, -5.713615579741575E+00,  7.299044202702575E+00),
      new body("Teharonhiawako",color(230),89,2.44e18,5.299447849004092E+09, -4.132533757912849E+09,  9.016232156544685E+07,  2.766024076212461E+00,  3.417468586661061E+00,  1.901050147378993E-01),
      new body("Nemesis",color(230),88.97,5.97e18,3.567437964442126E+08,  2.307934473715901E+07, -3.748865135851304E+07, -1.899882690441925E+00,  2.022112266708393E+01,  7.213480655824549E-01),
      new body("Aegle",color(230),88.887,6.48e18,3.628102920757486E+08,  2.995731053251659E+08,  1.314119184261425E+08, -1.155305407860765E+01,  1.088165839206095E+01,  4.193945929136174E-01),
      new body("Diotima",color(230),87.929,6.91e18,-1.941786090767374E+08,  4.300307080705832E+08,  6.583911997605333E+07, -1.457274024059327E+01, -7.098350982302621E+00,  2.224538702384169E+0),

      new body("Galatea",color(230),87.4,2.12e18,2.513826307222148E+09, -3.739218596641852E+09,  1.907032400887036E+07, -2.473657719960969E+00,  9.145138634026615E+00,  4.851487117036841E+00),
      new body("Aletheia",color(230),87.159,7.79e18,3.273818703774908E+08,  3.979891088470547E+08, -5.880443383965094E+07, -1.082636369065797E+01,  1.033779696305400E+01,  2.158340621319073E+00),
      //new body("Phorcys",color(230),87,1.67e18,),

      new body("Hilda",color(230),85.315,1e18,1.704659324063142E+08, -4.800489847079759E+08,  6.150258182932907E+07,  1.629138360396496E+01,  5.236458423740698E+00,  1.197203889795591E+00),
      new body("Pretoria",color(230),85.185,4.58e18,-4.165425058910914E+08,  3.495580268132749E+08, -1.883242580183944E+08, -7.720962342376080E+00, -1.183215417667397E+01, -1.404470268647477E+00),
      new body("Himalia",color(230),85,4.2e18,5.930434497474809E+08,  4.477055954896410E+08, -1.039819034577218E+07, -1.072991564826921E+01,  9.733833373018268E+00,  1.260765620494572E+0),
      //new body("Namaka",color(230),85,1.79e18,),

      //new body("Weywot",color(230),85,1e18,),
      new body("Rhadamanthus",color(230),84,1e18,-5.730616874811975E+09, -3.526175633600056E+08,  1.466354601937045E+08, -4.811558505337604E-01, -4.710537555971423E+00, -1.030931582996531E+00),

      new body("Amalthea",color(230),83.5,2.08e18,5.979569575343418E+08,  4.388437781576736E+08, -1.519407582490766E+07, -2.831981909402541E+01,  2.808129205986423E+01,  3.347943048308935E-01),
      new body("Agamemnon",color(230),83.33,1e18,-3.523655352829918E+08,  6.395200787810436E+08,  1.848237850899223E+08, -1.214482482361463E+01, -4.762913449830394E+00, -3.583468832553337E+00),

      new body("Sycorax",color(230),82.5,1e18,2.170607274008604E+09, -2.048491776500012E+09, -4.119442742917061E+07,  4.614169965760141E+00,  4.101052411757777E+00, -9.281835533675697E-02),
      new body("Puck",color(230),81,1e18,2.157631499756048E+09, -2.055221453554389E+09, -3.555682487543225E+07,  8.229497723045045E+00,  4.806663246392422E+00,  7.343499912161058E+00),

      new body("Manwe",color(230),80,1.94e18,6.029131371131653E+09, -3.112071690896374E+09, -3.143768098798847E+08,  1.567263333465783E+00,  4.044161913019119E+00,  1.076156110709103E-03),

      new body("Despina",color(230),78,1e18,2.513825890147097E+09, -3.739287956167210E+09,  1.904564213960266E+07,  1.050552678664169E+01,  1.270729573424771E+01,  8.124759740208685E-01),

      new body("Io 85",color(230),77.395,2.57e18,2.842439564706832E+08,  2.195350708719724E+08, -1.862452025633390E+07, -9.291273450117995E+00,  1.725212658027993E+01, -4.143072415738928E+0),

      new body("Patroclus",color(230),70.181,1.36e18,5.289956695891483E+08, -3.471959242822181E+08, -2.505835623716836E+08,  7.836004483392697E+00,  1.250332193043257E+01,  1.401759691225932E+0),

      new body("Portia",color(230),67.6,1e18,2.157645828179427E+09, -2.055232942866237E+09, -3.561658894695544E+07,  1.564961063485633E+00,  6.495648869758393E+00,  8.598202633156195E+00),

      new body("Achilles",color(230),65.049,1e18,-1.726481009938838E+08,  6.372519745788656E+08,  6.294997615216443E+07, -1.461804182092817E+01, -3.165437350138860E+00, -2.249588858264336E+00),
      new body("Anchises",color(230),60.245,1e18,6.232321873857626E+08, -2.851817476464720E+08,  6.511260922311883E+07,  6.369571068866748E+00,  1.328103204069203E+01,  1.135728462967635E+00),
      new body("Paris",color(230),59.395,1e18,6.898451373082119E+08, -1.278858898552808E+08, -2.052372342920480E+08,  2.293858116541300E+00,  1.247677307962952E+01, -5.586842898558357E+0),
      new body("Deiphobus",color(230),59.11,1e18,5.776951955374926E+08, -4.044456716889991E+08,  2.367576870528738E+08,  6.427057191986948E+00,  1.106125538422804E+01,  4.492530908993054E+0),
      new body("Aneas",color(230),59.01,1e18,6.875515603528453E+08, -9.407730415736814E+07,  2.016427417063485E+08,  3.244649957829265E+00,  1.357470308689723E+01, -6.667856826571716E-01),
      new body("Diomedes",color(230),58.893,1e18,-4.426998401581289E+08,  5.940972160276240E+08,  4.456712743363133E+07, -1.063980533706839E+01, -7.071533824794319E+00, -4.678842131160177E+00),

      new body("Epimetheus",color(230),58.1,5.266e18,9.577793836537281E+08,  9.820956512209973E+08, -5.517601487286109E+07, -2.044988740678274E+00,  1.982050301815769E+01, -7.097070935775968E+00),

      new body("Odysseus",color(230),57.312,1e18,-7.238900715517932E+07,  7.088092413283538E+08, -3.173849424592730E+07, -1.416260907750713E+01, -1.474132088947926E+00, -4.526734113220683E-01),
      new body("Alcathous",color(230),56.841,1e18,6.440756882023414E+08, -4.483319089990274E+08,  1.968980725531758E+08,  7.236754909743122E+00,  1.005996561365384E+01,  2.047761375061540E+00),
      new body("Nestor",color(230),56.16,1e18,-1.079065986620717E+08,  8.153070621467896E+08,  6.238092828850812E+07, -1.230000120218431E+01, -3.915515888122788E-01, -1.820416132468832E-01),
      new body("Makhaon",color(230),55.828,1e18,-1.657461146338984E+08,  7.130927220262479E+08,  1.345932624806798E+07, -1.307790655012766E+01, -3.354607781538116E+00, -2.910908383536111E+00),

      new body("Antilochus",color(230),54.421,1e18,-1.067054656573239E+08,  6.611251477161981E+08, -3.082900936290976E+08, -1.285207362290391E+01, -3.014567246946218E+00, -3.399778314148429E+00),

      new body("Troilus",color(230),50.239,1e18,6.091763808365766E+08, -1.000171931802131E+08, -3.479499824374647E+08,  4.293483637431425E+00,  1.312600886907029E+01,  3.638374903642790E+00),

      new body("Thebe",color(230),49.3,100e15,5.978738643455563E+08,  4.384860767649152E+08, -1.521267565098298E+07,  1.573431984449161E+01,  1.506738170515460E+01,  8.436526554361929E-01),
      new body("Juliet",color(230),46.8,100e15,2.157668746933645E+09, -2.055227729397679E+09, -3.554291854517603E+07,  1.204601875941108E+01,  3.806390792739502E+00,  5.843518291284004E+00),
      new body("Prometheus",color(230),43.1,159.5e15,9.576923764636682E+08,  9.820313611571367E+08, -5.513418548307782E+07,  7.732511302600680E+00,  1.179001756944059E+01, -3.945870765789960E+00),
      new body("Elara",color(230),43,150e15,5.918348416229084E+08,  4.330920181645743E+08, -1.094227809975109E+07, -5.204822838494715E+00,  8.180074417254742E+00, -6.021789553805870E-01),
      new body("Pandora",color(230),40.7,137.1e15,9.574966220490555E+08,  9.821495996908762E+08, -5.517730977210605E+07, -6.943378673602306E+00, -7.753711931651257E+00,  7.716198830554677E+00),
      new body("Thalassa",color(230),40.7,100e15,2.513780082960723E+09, -3.739219013085105E+09,  1.908890455579519E+07, -6.355822825071777E+00,  3.887928464200796E-01,  3.323681317537581E+00),
      new body("Belinda",color(230),40.3,100e15,2.157741039504203E+09, -2.055241184934761E+09, -3.552576943159342E+07,  1.222938409578895E+01,  2.423369963216019E+00, -3.880841141502833E+00),
      new body("Cressida",color(230),39.8,100e15,2.157703017724958E+09, -2.055250668790387E+09, -3.565391267961502E+07, -4.799996582578821E+00,  6.732312454354213E+00,  2.496444142776091E-01),
      new body("Rosalind",color(230),36,100e15,2.157690097775797E+09, -2.055230104781044E+09, -3.552597358283210E+07,  1.328149363685230E+01,  3.059326656547355E+00,  2.398644385241387E+00),
      new body("Caliban",color(230),36,50e15,2.151242390665613E+09, -2.053825775463736E+09, -3.486715031206107E+07,  4.835457770301079E+00,  5.332005086922663E+00,  5.749002388421234E-01),
      new body("Desdemona",color(230),32,50e15,2.157724282631576E+09, -2.055254948244443E+09, -3.565161240635383E+07, -4.359058121830325E+00,  6.156595005639971E+00, -3.049466035735366E+00),
      new body("Halimede",color(230),31,50e15,2.497502940593035E+09, -3.750391117551651E+09,  2.171911962181926E+07,  4.491448996829031E+00,  3.309620265352966E+00,  2.964541411288784E-01),
      new body("Naiad",color(230),30.2,50e15,2.513775477090746E+09, -3.739310398753708E+09,  1.905680062427950E+07,  1.497536658091772E+01,  2.402531839496621E+00, -5.753405989728812E+00),
      new body("Neso",color(230),30,100e15,2.468779483512594E+09, -3.694971548545536E+09, -2.957255932067776E+07,  4.652921638027841E+00,  3.144748278597076E+00, -1.414961425290553E-01),
      new body("Bianca",color(230),27,50e15,2.157764510926408E+09, -2.055255293930578E+09, -3.559009956837702E+07,  4.786724821530221E+00,  3.238449496832313E+00, -9.846609435476392E+00),
      new body("Prospero",color(230),25,50e15,2.165325782935199E+09, -2.072299586605746E+09, -3.012370664307928E+07,  4.196081074635133E+00,  4.619960541425113E+00,  1.469709283871636E-01),
      new body("Setebos",color(230),24,50e15,2.167577041645825E+09, -2.029946092511497E+09, -3.593245167698419E+07,  4.890687863776840E+00,  4.534380992187763E+00, -2.128438195357909E-01),
      new body("Carme",color(230),23,130e15,5.832780192994193E+08,  4.173685029938450E+08, -2.130065832487980E+07, -9.259174818116284E+00,  1.270456815522207E+01, -2.398740632660790E-02),
      new body("Sao",color(230),22,50e15,2.505151108102410E+09, -3.731195654557273E+09,  3.419323742267036E+07,  4.115966812018694E+00,  2.548095938987408E+00, -6.469386756617179E-02),
      new body("Metis",color(230),21.5,119.893e15,5.978490208431145E+08,  4.385772242052718E+08, -1.520617836119819E+07,  2.360856172434662E+01,  1.308516799595038E+01,  6.654464318366307E-01),
      new body("Ophelia",color(230),21.4,50e15,2.157757752015593E+09, -2.055252277860277E+09, -3.557894558981633E+07,  6.879337340556724E+00,  2.735425113142639E+00, -1.004842062117482E+01),
      new body("Laomedeia",color(230),21,50e15,2.540827123259228E+09, -3.739605729798767E+09,  2.247258559474468E+06,  4.590051393465348E+00,  3.405801915683956E+00, -7.791069255452343E-02),
      new body("Cordelia",color(230),20.1,50e15,2.157658065655959E+09, -2.055231989892566E+09, -3.559155900611758E+07,  5.201985439472336E+00,  5.976366817828459E+00,  1.066467307145194E+01),

      new body("Pasiphae",color(230),20,50e15,5.992723155243311E+08,  4.166648974784818E+08, -2.830953509297907E+06, -9.713527268516128E+00,  1.219361917051538E+01,  5.684411533231799E-01),
      new body("Siarnaq",color(230),20,50e15,9.684815736617622E+08,  9.690990884852778E+08, -7.267484480689543E+07, -6.867888783465977E+00,  7.513742718744542E+00,  7.741585115276894E-03),
      new body("Psamathe",color(230),20,50e15,2.561860989653727E+09, -3.744751199881688E+09, -2.094013552333307E+07,  4.568891213080306E+00,  2.859060379350116E+00, -1.991722692104436E-02),

      new body("Hydra",color(230),19.65,48e15,-1.478591442920227E+09, -4.182874461354923E+09,  8.752445208774980E+08,  5.192055821748362E+00, -2.772286458072291E+00, -1.280645383112182E+00),
      new body("Nix",color(230),19.017,45e15,-1.478633234455939E+09, -4.182859380623746E+09,  8.753423123087789E+08,  5.356008479458295E+00, -2.581064766622716E+00, -1.260547793918868E+00),
      new body("Sinope",color(230),19,10e15,5.738143399296634E+08,  4.559599310625801E+08, -1.081422488191107E+07, -7.228622190135846E+00,  1.255630552477879E+01, -6.037103113377418E-01),
      new body("Lysithea",color(230),18,10e15,6.079362329750634E+08,  4.413764813162307E+08, -1.466465057080615E+07, -9.096835509156953E+00,  1.417623964840523E+01,  1.811989956556200E+00),
      new body("Helene",color(230),17.6,10e15, 9.577902091883619E+08,  9.818374040405532E+08, -5.504202743429202E+07,  1.740086065626104E+00,  1.004435120174771E+01, -2.405910012833302E+00),
      new body("Hippocamp",color(230),17.4,50e15,2.513764824691495E+09, -3.739171237206272E+09,  1.911309093798208E+07, -2.869863251636797E+00,  4.972164318037307E-01,  1.930661184560841E+00),
      new body("Albiorix",color(230),16,5e15,9.526379909598078E+08,  9.759114658299731E+08, -4.996524529699218E+07, -6.319621218776243E+00,  4.633643916900369E+00, -2.857491765580455E-02),
      new body("Stephano",color(230),16,5e15,2.158950794979879E+09, -2.061704196800805E+09, -4.080142584160972E+07,  3.843557774819359E+00,  4.553395250406477E+00,  1.398449735007490E-02),

      new body("Ida",color(230),15.7,42e15,3.148584786681724E+08, -3.023699900071974E+08, -1.188947499810338E+06,  1.140494413726435E+01,  1.291611473891078E+01,  3.401567711840077E-01),

      new body("Atlas",color(230),15.1,6.6e15,9.575137603031569E+08,  9.821017980901275E+08, -5.515378565197420E+07, -5.086289619995474E-01, -6.964322577700655E+00,  6.680553086926720E+00),
      new body("Pan",color(230),14.1,4.95e15,9.577464723540734E+08,  9.820742421294184E+08, -5.516188445288211E+07,  2.393214487809314E+00,  1.849283957251714E+01, -6.938625718810619E+00),
      new body("Ananke",color(230),14,3e15,6.090853203045055E+08,  4.584187322948110E+08, -2.409804014169818E+07, -6.499140260578518E+00,  9.798455194360908E+00,  1.016366687596304E+00),
      new body("Perdita",color(230),13,3e15,2.157636241817595E+09, -2.055231276495864E+09, -3.561972432270980E+07,  1.823118876328207E+00,  6.347978433951322E+00,  8.033188560215562E+00),
      new body("Telesto",color(230),12.4,3e15,9.576965306015471E+08,  9.818866952856243E+08, -5.506552523881441E+07,  3.663734319966816E+00,  8.315786296196675E+00, -1.676348627039692E+00),
      new body("Mab",color(230),12,3e15,2.157646152681381E+09, -2.055219745377301E+09, -3.551996031557345E+07,  1.047968793962243E+01,  4.023945044167364E+00,  4.988514165482306E+00),

      new body("Phobos",color(230),11.267,10.659e15,2.069321721543608E+08, -3.553309714039974E+06, -5.150101792160033E+06, -2.368742384373939E-01,  2.757687588862674E+01,  1.326425169336574E+00),

      new body("Paaliaq",color(230),11,3e15,9.501856591182860E+08,  9.906414731655726E+08, -4.700330526681352E+07, -8.269853633281326E+00,  5.778957898513210E+00, -9.515145508480700E-01),
      new body("Francisco",color(230),11,3e15,2.159917033420498E+09, -2.058107462618658E+09, -3.463641264481211E+07,  3.882128500768749E+00,  3.723286138573813E+00, -6.453158406433253E-01),
      new body("Calypso",color(230),10.7,3e15,9.573573420220901E+08,  9.822353412017912E+08, -5.520003906192666E+07, -1.058825123280135E+01, -2.774277461351363E+00,  5.528465317191362E+00),
      new body("Leda",color(230),10,3e15,6.093368613918855E+08,  4.366460907423011E+08, -1.073835935157549E+07, -7.405391592404012E+00,  1.391530251848310E+01, -8.725320290639003E-01),
      new body("Margaret",color(230),10,3e15,2.165371824449222E+09, -2.059913928930860E+09, -4.509845491724622E+07,  4.597453462594219E+00,  5.062739613769526E+00,  4.882890202406267E-01),
      new body("Ferdinand",color(230),10,3e15,2.170892162684068E+09, -2.054133003215123E+09, -3.747403869707489E+07,  4.883637111616738E+00,  3.904768234743520E+00, -1.970371666990791E-01),

      new body("Euler",color(230),9.887,3e15,3.607461734948350E+08, -8.367947067168225E+07,  1.143994245396205E+07,  5.358959890865251E+00,  1.764587731092397E+01, -2.659160519701635E+00),

      new body("Cupid",color(230),9,3e15,2.157637000103641E+09, -2.055224857371058E+09, -3.557244951453340E+07,  7.222141379465236E+00,  5.193004747454347E+00,  8.344918269265321E+00),
      new body("Ymir",color(230),9,3e15,9.813530296453868E+08,  9.635631318864291E+08, -5.850316712983072E+07, -8.100226668963593E+00,  6.138413145689285E+00,  1.466187204494096E-01),
      new body("Trinculo",color(230),9,3e15,2.149235447323764E+09, -2.061220540947395E+09, -3.630900320242500E+07,  4.273536069517895E+00,  5.134779092901298E+00,  1.082583901303331E-01),

      new body("Romulus",color(230),9,93.19e15,-3.947856724471234E+08, -2.921696991957510E+08, -1.446560672185199E+07,  1.033245901508819E+01, -1.106160335529695E+01, -6.300867494398238E+00),
      new body("Eros",color(230),8.42,6.687e15,-1.804046432062261E+08, -8.326601448212524E+07, -3.722385511116661E+07,  6.107484722252957E+00, -2.592490852038297E+01, -1.839187259557598E+00),

      new body("Adrastea",color(230),8.2,3e15,5.979519258764721E+08,  4.386388701803218E+08, -1.520245304628700E+07,  8.205407021242884E+00,  3.814389592275482E+01,  1.325786940804395E+00),
      new body("Kiviuq",color(230),8,3e15,9.549770662697333E+08,  9.738750384938551E+08, -6.494144243330473E+07, -5.903758074926081E+00,  6.374979959244376E+00,  1.833257651615572E-03),

      new body("Tarvos",color(230),7.5,3e15,9.415212442052504E+08,  9.647026343486347E+08, -4.325245659532082E+07, -6.694610589960970E+00,  6.466417223906423E+00, -2.900874469287418E-01),

      new body("Kerberos",color(230),6.333,16e15,-1.478616068824153E+09, -4.182901422047250E+09,  8.752459058324547E+08,  5.160271933658396E+00, -2.764020096567886E+00, -1.213932371879942E+00),

      new body("Deimos",color(230),6.2,1.476e15,2.069078452791673E+08, -3.552199204991873E+06, -5.137479041260836E+06,  8.403785206215839E-01,  2.502391499509857E+01,  6.871254361062284E-01),

      new body("Ijiraq",color(230),6,1e15,9.601509898404959E+08,  9.760773987869321E+08, -5.022330765895218E+07, -5.158985628694556E+00,  6.234122857890197E+00, -5.364037017548264E-01),

      new body("Halley's Commet",color(230),5.5,22e15,-2.601883243824225E+09,  2.539468994390954E+09, -1.133567990651788E+09, -2.081803025577760E+00,  3.781514230504282E+00, -1.197131836691762E+00),

      new body("Styx",color(230),5.5,7.63e15,-1.478595403395558E+09, -4.182853447701653E+09,  8.752858035340304E+08,  5.261129277478650E+00, -2.751232724731954E+00, -1.367947516965776E+00),

      new body("Erriapus",color(230),5,0.1e15,9.665963490218931E+08,  9.683685102746766E+08, -5.077309223110735E+07, -6.974655403769164E+00,  7.893975123621771E+00, -6.542799709032687E-01),
      new body("Callirrhoe",color(230),4.3,0.1e15,5.847323424270576E+08,  4.590940179161008E+08, -6.496532905978709E+06, -6.894827040516671E+00,  1.265429142433575E+01, -9.079593682081089E-01),

      new body("Misterrogers",color(230),4.035,0.1e15,-1.944629149013710E+08,  1.407434623679321E+08, -8.353207176012564E+07, -2.008852884152067E+01, -1.604842075363304E+01,  2.586425712571822E+00),

      new body("Themisto",color(230),4,0.1e15,6.042657854889121E+08,  4.379954942246563E+08, -1.196185658539367E+07, -7.110225985117523E+00,  1.430922428949466E+01, -2.575103058459112E+00),

      new body("Daphnis",color(230),3.8,0.077e15,9.577672071177382E+08,  9.821037492566323E+08, -5.517934811226940E+07, -2.097422322473410E+00,  2.053823184875282E+01, -7.575609620527191E+00),
      new body("Bestla",color(230),3.5,0.1e15,9.829082252266268E+08,  9.803724711443126E+08, -7.136729451396555E+07, -7.697883676962266E+00,  6.029914789555032E+00,  4.624635558937782E-01),

      new body("Tempel 1 (9P)",color(230),3,0.1e15,-8.899657896612012E+07, -2.068847281734937E+08,  1.513256953774095E+06,  2.717282239950337E+01, -1.143073952452834E+01, -5.480589910965048E+00),
      new body("Tempel 2 (10P)",color(230),1,0.1e15,2.564404342435699E+08,  8.748968589104088E+07, -5.692025864553923E+07,  8.385937894905787E-01,  2.569678464037233E+01, -2.732980334640492E+00),

      new body("Annefrank",color(230),2.4,0.1e15,3.288142538710577E+08,  7.508503041909873E+07, -2.388161393316227E+07, -5.489683394041073E+00,  1.872582622365207E+01, -3.604776449517768E-01),

      new body("Cruithne",color(230),1.036,0.01e15,-6.019603868623201E+07,  4.543230975959450E+07,  7.399866864994377E+06, -2.174198061321629E+01, -4.386003871745089E+01,  1.566898154619552E+01),

      new body("2010 TK7",color(230),189.5,30e9,-6.860058439206806E+07,  9.898004830598472E+07,  2.122560977333641E+07, -2.612886399264764E+01, -2.210693075837603E+01,  1.086770095794010E+01),
      new body("2010 SO16",color(230),178.5,30e9,5.574971318394975E+07,  1.334567562109420E+08,  1.676739979596724E+07, -2.832599776014493E+01,  8.790351191205554E+00,  6.534349680487432E+00),
      new body("Kamo`oalewa",color(230),41,0.5e9,-5.683460057210533E+07,  1.362689000685836E+08,  1.397437057681002E+07, -2.861324965741253E+01, -8.525361361204366E+00,  3.168642898652954E+00),
      /* barycenters */
      //new body("Solar System Barycenter (SSB)",color(0),0,0,0,0,0,[0]),
      //new body("Mercury Barycenter",color(0),0,0,-2.212062175862221E+07, -6.682431829610253E+07, -3.461601353176080E+06, 3.666229236478603E+01, -1.230266986781422E+01, -4.368336051784789E+00,[8]),
      //new body("Venus Barycenter",color(0),0,0,-1.085735509178141E+08, -3.784200933160055E+06,  6.190064472977990E+06,  8.984651054838754E-01, -3.517203950794635E+01, -5.320225582712421E-01,[6]),
        //new body("Earth-Moon Barycenter (EMB)",color(0),0,0,-2.628278892285838E+07,  1.445073003367372E+08,  3.067235597968847E+04, -2.982371414236500E+01, -5.230185329768933E+00, -1.213810126514669E-04,[5,13]),
      //new body("Mars Barycenter",color(0),0,0,2.069270543360729E+08, -3.560689811477710E+06, -5.147936603828508E+06,  1.304308812694964E+00,  2.628158892250333E+01,  5.188465934952333E-01,[7]),
      //new body("Jupiter Barycenter",color(0),0,0,5.978411018921824E+08,  4.387049769612203E+08, -1.520170016953275E+07, -7.892151874487445E+00,  1.114945115750926E+01,  1.304862310943014E-01,[1]),
      //new body("Saturn Barycenter",color(0),0,0,9.576381404895931E+08,  9.821477386679871E+08, -5.518990106544006E+07, -7.420583259777167E+00,  6.725272210562052E+00,  1.779635671891335E-01,[2]),
      //new body("Uranus Barycenter",color(0),0,0,2.157706693154863E+09, -2.055242913196469E+09, -3.559266720965648E+07,  4.646804486524291E+00,  4.614387135494279E+00, -4.306254213333638E-02,[4]),
      //new body("Neptune Barycenter",color(0),0,0,2.513785356833091E+09, -3.739265096828156E+09,  1.907035719387865E+07,  4.475371931235400E+00,  3.063567701145199E+00, -1.662252948584049E-01,[3]),
        //new body("Pluto Barycenter",color(0),0,0,-1.478626345058959E+09, -4.182879252045648E+09,  8.752984506169835E+08,  5.253371945580917E+00, -2.675695673555306E+00, -1.233257601938801E+00,[17,26,223,224,227,232]),

      //new body(w/6   ,h/2,80000,0, -6,color(255,0,0)),
      //new body(w*5/6,h/2,160000,0, 3,color(50,150,250)),
      //new body(w/2   ,h/2,3,0, 0,color(0,200,0)),
      //new body(w/3   ,h/3,1,-3, 0,color(255,0,0)),
      //new body(w*2/3   ,h*2/3,0.5,3, 0,color(50,150,250)),
      //new body(w*11/12,h/2,1,0,-3,color(50,150,250)),

      //new body("2002 AW",color(230),384,3e20,-1.604458904014602E+08,  7.423705729773158E+07, -2.170340085078478E+05, -5.149833263865792E+00, -2.554488985956115E+01,  2.556986405650736E-01),
      //new body(w/2   ,h/2,3,0, 0,color(0,200,0)),
  ];
  var satmag=allBodies[2].pos.mag()*0.9;
  for(var i=0;i<allBodies.length;i++){
    nbody[allBodies[i].name]=allBodies[i];
    if(allBodies[i].name.indexOf("20")<0){
      presets[1].bodies.push(i);
    }
    if(allBodies[i].m>1e20){
      presets[2].bodies.push(i);
    }
    if(allBodies[i].m>1e18){
      presets[3].bodies.push(i);
    }
    presets[4].bodies.push(i);
    if(allBodies[i].pos.mag()<satmag){
      presets[5].bodies.push(i);
    }
    if(allBodies[i].pos.mag()>satmag*1.5){
      presets[6].bodies.push(i);
    }
    if(allBodies[i].name.indexOf("20")>=0){
      presets[7].bodies.push(i);
    }
    if(i!=1&&allBodies[i].pos.dist(allBodies[1].pos)<1e8){
      presets[8].bodies.push(i);
    }
    if(i!=2&&allBodies[i].pos.dist(allBodies[2].pos)<1e8){
      presets[9].bodies.push(i);
    }
    if(i!=3&&allBodies[i].pos.dist(allBodies[3].pos)<1e8){
      presets[10].bodies.push(i);
    }
    if(i!=4&&allBodies[i].pos.dist(allBodies[4].pos)<1e8){
      presets[11].bodies.push(i);
    }
    if(i!=16&&allBodies[i].pos.dist(allBodies[16].pos)<1e8){
      presets[12].bodies.push(i);
    }
  }
  applyPreset();
  dir=createVector(0,0);

  textFont("monospace");
}
var KM_AU=1.496e+8;
var tickspf=1;

var currentDate=946713600000;

var scle=5e-7;
var bubble=2e7;
var mlt=15;

var thetas=[0,0];
var focusBody=0;
var speed=360;
//speed/=1000;
var sensi=1;
var trails=true;
var sunCenter=false;
var showNames=true;
var extrude=true;
var trailSize=1;
var trailsPerFrame=2;
var continuousTrail=true;
var FB;
var sinT0=0;
var cosT0=0;
var sinT1=0;
var cosT1=0;
var stats=true;

var sml=1;

var humanTime=function(mil){
  if(mil<0){
    return "-"+humanTime(-mil);
  }
  var t=mil;
  if(t<1000){
    return (t*100>>0)/100+" ms";
  }
  t/=1000;
  if(t<60){
    return (t*100>>0)/100+" sec";
  }
  t/=60;
  if(t<60){
    return (t*100>>0)/100+" min";
  }
  t/=60;
  if(t<48){
    return (t*100>>0)/100+" hrs";
  }
  t/=24;
  if(t<21){
    return (t*100>>0)/100+" days";
  }
  t/=7;
  if(t<16){
    return (t*100>>0)/100+" weeks";
  }
  t/=365.25/7;
  return (t*100>>0)/100+" yrs";
};
//takes milliseconds

function draw() {
  FB=bodies[focusBody];
  background(0);
  push();
  if(mouseIsPressed){
    thetas[0]+=(mouseX - pmouseX)/100*sensi;
    thetas[1]-=(mouseY - pmouseY)/100*sensi;
  }
  if(sunCenter){
    thetas[0]=-Math.atan2(bodies[focusBody].pos.y-bodies[0].pos.y,bodies[focusBody].pos.x-bodies[0].pos.x)*sml-Math.PI/2;
  }

  sinT0=Math.sin(thetas[0]);
  cosT0=Math.cos(thetas[0]);
  sinT1=Math.sin(thetas[1]);
  cosT1=Math.cos(thetas[1]);

  textAlign(CENTER,TOP);
  translate(w/2,h/2);
  scale(scle,-scle);
  t++;

  var t=[bodies[focusBody].pos.x,bodies[focusBody].pos.y,bodies[focusBody].pos.z];

  t=[t[0]*cosT0-t[1]*sinT0,t[0]*sinT0+t[1]*cosT0,t[2]];

  t=[t[0],t[1]*cosT1-t[2]*sinT1,t[1]*sinT1+t[2]*cosT1];

  translate(-t[0],-t[1]);

  bodies.sort((a,b)=>{
    var t=[a.pos.x,a.pos.y,a.pos.y];

    t=[t[0]*cosT0-t[1]*sinT0,t[0]*sinT0+t[1]*cosT0,t[2]];

    t=[t[0],t[1]*cosT1-t[2]*sinT1,t[1]*sinT1+t[2]*cosT1];
    var v1=t[2];
    var t=[b.pos.x,b.pos.y,b.pos.y];

    t=[t[0]*cosT0-t[1]*sinT0,t[0]*sinT0+t[1]*cosT0,t[2]];

    t=[t[0],t[1]*cosT1-t[2]*sinT1,t[1]*sinT1+t[2]*cosT1];
    return t[2]-v1;
  });

  noStroke();
  if(trails){
    for(var i=0;i<bodies.length;i++){
      bodies[i].drawTrail();
    }
  }
  for(i=0;i<bodies.length;i++){
    bodies[i].draw();
  }

  bodies.sort((a,b)=>(b.m+1)*(1+1e-10*b.nameMass)-(a.m+1)*(1+1e-10*a.nameMass));

  for(var j=0;j<tickspf;j++){
    for(var i=0;i<bodies.length;i++){
      bodies[i].changeV(i);
    }
    for(var i=0;i<bodies.length;i++){
      bodies[i].move(false);
    }
  }
  for(var i=0;i<bodies.length;i++){
    bodies[i].changeV(i);
  }
  for(var i=0;i<bodies.length;i++){
    bodies[i].move(true);
  }

  pop();
  if(stats){
    textSize(30);
    textAlign(LEFT,TOP);
    fill(255);
    var dat=new Date(currentDate);
    text(dat.toString().split(' ').splice(0,5).join(' ')+"\n"+bodies[focusBody].name,5,5);
    textAlign(RIGHT,TOP);
    text(presets[onPreset].name+"\n"+bodies.length+" bodies\n"+(tickspf>>0)+" steps/frame\n"+humanTime(speed*1000)+"/step"+(trails?"\n"+(trailsPerFrame>>0)+" trails/frame\n"+(pts>>0)+" point trail length":""),w-5,5);

    textSize(20);
    textAlign(LEFT,BOTTOM);
    if(10000*scle*KM_AU<w/2){
      text("10,000 AU",5,h-15);
      rect(5,h-10,10000*scle*KM_AU,5);
    }
    else if(1000*scle*KM_AU<w/2){
      text("1,000 AU",5,h-15);
      rect(5,h-10,1000*scle*KM_AU,5);
    }
    else if(100*scle*KM_AU<w/2){
      text("100 AU",5,h-15);
      rect(5,h-10,100*scle*KM_AU,5);
    }
    else if(10*scle*KM_AU<w/2){
      text("10 AU",5,h-15);
      rect(5,h-10,10*scle*KM_AU,5);
    }
    else if(scle*KM_AU<w/2){
      text("1 AU",5,h-15);
      rect(5,h-10,scle*KM_AU,5);
    }
    else if(scle*KM_AU/10<w/2){
      text("0.1 AU",5,h-15);
      rect(5,h-10,scle*KM_AU/10,5);
    }
    else if(scle*1000000<w/2){
      text("1 million km",5,h-15);
      rect(5,h-10,scle*1000000,5);
    }
    else if(scle*100000<w/2){
      text("100 thousand km",5,h-15);
      rect(5,h-10,scle*100000,5);
    }
    else if(scle*10000<w/2){
      text("10 thousand km",5,h-15);
      rect(5,h-10,scle*10000,5);
    }
    else if(scle*1000<w/2){
      text("1 thousand km",5,h-15);
      rect(5,h-10,scle*1000,5);
    }
    else if(scle*100<w/2){
      text("100 km",5,h-15);
      rect(5,h-10,scle*100,5);
    }
    else if(scle*10<w/2){
      text("10 km",5,h-15);
      rect(5,h-10,scle*10,5);
    }
    else if(scle<w/2){
      text("1 km",5,h-15);
      rect(5,h-10,scle,5);
    }
    else if(scle/10<w/2){
      text("100 m",5,h-15);
      rect(5,h-10,scle/10,5);
    }
    else if(scle/100<w/2){
      text("10 m",5,h-15);
      rect(5,h-10,scle/100,5);
    }
    else{
      text("1 m",5,h-15);
      rect(5,h-10,scle/1000,5);
    }
    textSize(30);
  }
}

function spher(x,y,z,d,c,name){
  var t=[x,y,z];

  t=[t[0]*cosT0-t[1]*sinT0,t[0]*sinT0+t[1]*cosT0,t[2]];

  t=[t[0],t[1]*cosT1-t[2]*sinT1,t[1]*sinT1+t[2]*cosT1];

  if(name&&showNames){
    push();
    translate(t[0],t[1]);
    scale(d/30,-d/30);
    fill(0);
    var tw=textWidth(name+"  ");
    rect(-tw/2,15,tw,40);
    fill(255);
    text(name,0,20);
    pop();
    fill(c);
  }
  else if(c){fill(c);}
  ellipse(t[0],t[1],d,d);
};
function vert3d(x,y,z,d){
  var t=[x,y,z];

  t=[t[0]*cosT0-t[1]*sinT0,t[0]*sinT0+t[1]*cosT0,t[2]];

  t=[t[0],t[1]*cosT1-t[2]*sinT1,t[1]*sinT1+t[2]*cosT1];

  vertex(t[0],t[1],d,d);
};
/*
function line3d(x1,y1,z1,x2,y2,z2,d,c){
  var t=[x1,y1,z1];

  t=[t[0]*cosT0-t[1]*sinT0,t[0]*sinT0+t[1]*cosT0,t[2]];

  t=[t[0],t[1]*cosT1-t[2]*sinT1,t[1]*sinT1+t[2]*cosT1];
  tt=[t[0],t[1]];
  t=[x2,y2,z2];

  t=[t[0]*cosT0-t[1]*sinT0,t[0]*sinT0+t[1]*cosT0,t[2]];

  t=[t[0],t[1]*cosT1-t[2]*sinT1,t[1]*sinT1+t[2]*cosT1];

  if(c){stroke(c);}
  strokeWeight(d);
  line(t[0],t[1],tt[0],tt[1]);
  noStroke();
}*/
var id=0;
var body=function(name,c,r,mass,x,y,z,vx,vy,vz,exclude){
  this.name=name;
  this.pos=createVector(x,y,z);//position
  this.nameMass=0;
  this.name.toLowerCase().split('').reverse().map(a=>{this.nameMass+=a.charCodeAt(0);this.nameMass/=1<<8;})
  this.m=mass;//mass
  this.v=createVector(vx,vy,vz);//velocity
  this.c=c;//color
  this.r=r;//radius
  this.hide=mass<=0;
  this.id=id++;
  this.counter=0;
  this.exclude=exclude?exclude:[];

  this.bodytpos=[x,y,z];
  this.bodytv=[vx,vy,vz];
  points[this.id]=[];
  while(points[this.id].length<pts){points[this.id].push([-1,-1]);}
}
body.prototype.reset=function(newId){
  this.pos.x=this.bodytpos[0];
  this.pos.y=this.bodytpos[1];
  this.pos.z=this.bodytpos[2];
  this.v.x=this.bodytv[0];
  this.v.y=this.bodytv[1];
  this.v.z=this.bodytv[2];
  this.id=newId;
  points[this.id]=[];
  while(points[this.id].length<pts){points[this.id].push([-1,-1]);}
}
body.prototype.draw=function(){
    if(this.hide){return;}
    spher(this.pos.x,this.pos.y,this.pos.z,this.r*2*mlt+bubble,this.c,this.name);
    //ellipse(this.pos.x,this.pos.y,Math.sqrt(this.m)*mlt+bubble,Math.sqrt(this.m)*mlt+bubble);
}
body.prototype.drawTrail=function(){
  if(this.hide){return;}
  if(continuousTrail){strokeWeight(1/scle*trailSize);stroke(this.c);noFill();beginShape();}
  for(i=0;i<points[this.id].length;i++){
    if(extrude){
      if(continuousTrail){
        vert3d(
          points[this.id][i][0]-points[FB.id][i][0]+FB.pos.x,
          points[this.id][i][1]-points[FB.id][i][1]+FB.pos.y,
          points[this.id][i][2]-points[FB.id][i][2]+FB.pos.z);
        /*line3d(
          points[this.id][i-1][0]-points[FB.id][i-1][0]+FB.pos.x,
          points[this.id][i-1][1]-points[FB.id][i-1][1]+FB.pos.y,
          points[this.id][i-1][2]-points[FB.id][i-1][2]+FB.pos.z,
          points[this.id][i][0]-points[FB.id][i][0]+FB.pos.x,
          points[this.id][i][1]-points[FB.id][i][1]+FB.pos.y,
          points[this.id][i][2]-points[FB.id][i][2]+FB.pos.z,
          1/scle*trailSize,this.c);*/
      }
      else{
        spher(
          points[this.id][i][0]-points[FB.id][i][0]+FB.pos.x,
          points[this.id][i][1]-points[FB.id][i][1]+FB.pos.y,
          points[this.id][i][2]-points[FB.id][i][2]+FB.pos.z,
          1/scle*trailSize,this.c);
      }
    }
    else{
      if(continuousTrail){
        vert3d(
          points[this.id][i][0],
          points[this.id][i][1],
          points[this.id][i][2]);
        /*
        line3d(
          points[this.id][i-1][0],
          points[this.id][i-1][1],
          points[this.id][i-1][2],
          points[this.id][i][0],
          points[this.id][i][1],
          points[this.id][i][2],
          1/scle*trailSize,this.c);
          */
      }
      else{
        spher(
          points[this.id][i][0],
          points[this.id][i][1],
          points[this.id][i][2],
          1/scle*trailSize,this.c);
      }
      //spher(points[this.id][i][0],points[this.id][i][1],points[this.id][i][2],1/scle*trailSize);
    }
    //point(points[i][0],points[i][1]);
  }
  if(continuousTrail){endShape();noStroke();}
}
body.prototype.move=function(pt){
  this.v.mult(speed);
  this.pos.add(this.v);
  this.v.div(speed);
  if(this.mass>0&&pt||this.counter++>tickspf/trailsPerFrame){
    points[this.id].push([this.pos.x,this.pos.y,this.pos.z]);
    while(points[this.id].length>pts){points[this.id].shift();}
    this.counter=0;
  }
}
body.prototype.changeV=function(id){
/*

    dir.x=bodies[i].x-this.x;
    dir.y=bodies[i].y-this.y;
    dir.normalize();
    dir.mult(bodies[i].m*( (bodies[i].x-this.x)*(bodies[i].x-this.x)+(bodies[i].y-this.y)*(bodies[i].y-this.y) ));
    this.v.add(dir);
*/
    if(id===0){
      currentDate+=speed*1000;
      return;
    }
    var tv=this.v.y;
    for(var i=0;i<bodies.length;i++){
        if(i!=id&&bodies[i].m&&this.exclude.indexOf(i)<0){
            dir.x=bodies[i].pos.x-this.pos.x;
            dir.y=bodies[i].pos.y-this.pos.y;
            dir.z=bodies[i].pos.z-this.pos.z;
            //var dis=dir.x*dir.x+dir.y*dir.y+dir.z*dir.z;
            var dis=dir.mag();
            dis*=dis;
            dir.normalize();
            if(speed*G*bodies[i].m/dis>=Infinity){
              //console.log(bodies[i]);
            }
            dir.mult(speed*G*bodies[i].m/dis);
            this.v.add(dir);
        }
    }
}
function resetbodies(){
  currentDate=946713600000;
  points=[];
  for(var i=0;i<bodies.length;i++){
    bodies[i].reset(i);
  }
}
function applyPreset(){
  bodies=[];
  for(var i=0;i<presets[onPreset].bodies.length;i++){
    bodies.push(allBodies[presets[onPreset].bodies[i]]);
  }
  focusBody=presets[onPreset].focus;
  resetbodies();
}
function goToDate(goTo,stepSize,precision){
  speed=stepSize?stepSize:360;
  var Precision=precision?precision:5;
  resetbodies();
  var j=0
  if(currentDate>goTo){
    speed*=-1;
    while(currentDate>goTo){
      for(var i=0;i<bodies.length;i++){
        bodies[i].changeV(i);
      }
      for(var i=0;i<bodies.length;i++){
        bodies[i].move(false);
      }
    }
    speed/=-2;
    j++;
  }
  for(;j<Precision;j++){
    while(currentDate<goTo){
      for(var i=0;i<bodies.length;i++){
        bodies[i].changeV(i);
      }
      for(var i=0;i<bodies.length;i++){
        bodies[i].move(false);
      }
    }
    speed/=-2;
    while(currentDate>goTo){
      for(var i=0;i<bodies.length;i++){
        bodies[i].changeV(i);
      }
      for(var i=0;i<bodies.length;i++){
        bodies[i].move(false);
      }
    }
    speed/=-2;
  }
  speed=1/tickspf/30;
}
function step(seconds){
  tspeed=speed;
  speed=seconds?seconds:speed;
  for(var i=0;i<bodies.length;i++){
    bodies[i].changeV(i);
  }
  for(var i=0;i<bodies.length;i++){
    bodies[i].move(false);
  }
  speed=tspeed;
}
function getNextApproach(bodya,bodyb,initialStepSize,precision){
  var stepSize=initialStepSize?initialStepSize:360;

  var ldis=bodya.pos.dist(bodyb.pos);
  step(stepSize);
  var dis=bodya.pos.dist(bodyb.pos);
  while(dis>ldis){
  	step(stepSize);
  	ldis=dis;
  	dis=bodya.pos.dist(bodyb.pos);
  }
  var Precision=precision?precision:5;
  for(var i=0;i<Precision;i++){
    ldis=bodya.pos.dist(bodyb.pos);
    step(stepSize);
    dis=bodya.pos.dist(bodyb.pos);
    while(dis<ldis){
    	step(stepSize);
    	ldis=dis;
    	dis=bodya.pos.dist(bodyb.pos);
    }
    stepSize/=-2;
    ldis=bodya.pos.dist(bodyb.pos);
    step(stepSize);
    dis=bodya.pos.dist(bodyb.pos);
    while(dis<ldis){
    	step(stepSize);
    	ldis=dis;
    	dis=bodya.pos.dist(bodyb.pos);
    }
    stepSize/=-2;
  }
  console.log(bodya.name+" is closest to "+bodyb.name+" on\n"+new Date(currentDate).toString().split(' ').splice(0,5).join(' ')+" at a distance of\n"+dis+" km, or\n"+dis/KM_AU+" AU");
  return dis;
};
var shifting=false;
var holding=[{},{}];
function keyReleased() {
  holding[0][key]=false;
  holding[1][keyCode]=false;
}
function keyPressed() {
  if(holding[1][UP_ARROW]){
    if (key === "w") {
      tickspf*=1.5;
    }
    else if (key === "t") {
      trailsPerFrame*=1.5;
    }
    else if (key === "T") {
      trailSize*=1.5;
    }
  }
  else if(holding[1][DOWN_ARROW]){
    if (key === "w") {
      tickspf/=1.5;
    }
    else if (key === "t") {
      trailsPerFrame/=1.5;
    }
    else if (key === "T") {
      trailSize/=1.5;
    }
  }
  else if(holding[0]["w"]){
    if (keyCode === UP_ARROW) {
      tickspf*=1.5;
    }
    else if (keyCode === DOWN_ARROW) {
      tickspf/=1.5;
      if(tickspf<1){tickspf=1;}
    }
    else if (keyCode === LEFT_ARROW) {
      tickspf=1;
    }
    else if (keyCode === RIGHT_ARROW) {
      tickspf=100;
    }
  }
  else if(holding[0]["t"]){
    if (keyCode === UP_ARROW) {
      trailsPerFrame*=1.5;
    }
    else if (keyCode === DOWN_ARROW) {
      trailsPerFrame/=1.5;
    }
    else if (keyCode === LEFT_ARROW) {
      trailsPerFrame=1;
    }
    else if (keyCode === RIGHT_ARROW) {
      trailsPerFrame=10;
    }
  }
  else if(holding[0]["T"]){
    if (keyCode === UP_ARROW) {
      trailSize*=1.5;
    }
    else if (keyCode === DOWN_ARROW) {
      trailSize/=1.5;
    }
  }
  else if (holding[1][SHIFT]){
    if (key === " ") {
      speed=1/tickspf*60*60;
    }
    else if (keyCode === BACKSPACE) {
      scle=5e-7;
      bubble=2e7;
      mlt=15;
    }
    else if (keyCode === CONTROL) {
      thetas[1]=Math.PI/2;
    }
    else if (key === "E") {
      bubble*=15;
    }
    else if (key === "D") {
      bubble/=15;
    }
    else if (key === "T") {
      continuousTrail=!continuousTrail;
    }
    else if (key === "Q") {
      sensi*=1.5;
    }
    else if (key === "A") {
      sensi/=1.5;
    }
    else if (key === "R") {
      resetbodies();
    }
    else if (key === "N") {
      showNames=!showNames;
    }
    else if (key === "H") {
      for(var i=0;i<bodies.length;i++){
        bodies[i].hide=!bodies[i].hide;
      }
      bodies[focusBody].hide=false;
    }
    else if (key === "Z") {
      thetas=[0,0];
    }
    else if (key === "P") {
      onPreset--;
      if(onPreset<0){onPreset=presets.length-1;}
      applyPreset();
    }
  }
  else if (key === " ") {
    speed=1/tickspf/30;
  }
  else if (keyCode === BACKSPACE) {
    bubble=1;
    mlt=1;
  }
  else if (keyCode === CONTROL) {
    thetas[1]=0;
  }
  else if (key === "z") {
    thetas=[0,0];
    scle=5e-7;
    bubble=1;
    mlt=1;
  }
  else if (key === "o") {
    pts*=1.5;
    if(pts>1e10){pts=1e10;}
    for(var i=0;i<points.length;i++){
      while(points[i].length<pts){points[i].unshift([-1,-1]);}
    }
  }
  else if (key === "l") {
    pts/=1.5;
    if(pts<1){pts=1;}
    for(var i=0;i<points.length;i++){
      while(points[i].length>pts){points[i].shift();}
    }
  }
  else if (key === "r") {
    focusBody++;
    if(focusBody>=bodies.length){
      focusBody=0;
    }
  }
  else if (key === "f") {
    focusBody--;
    if(focusBody<0){
      focusBody=bodies.length-1;
    }
  }
  else if (key === "q") {
    mlt*=1.5;
  }
  else if (key === "a") {
    mlt/=1.5;
  }
  else if (key === "w") {
    speed*=1.5;
  }
  else if (key === "s") {
    speed/=1.5;
  }
  else if (key === "e") {
    bubble*=1.5;
  }
  else if (key === "d") {
    bubble/=1.5;
  }
  else if (key === "h") {
    bodies[focusBody].hide=!bodies[focusBody].hide;
  }
  else if (key === "n") {
    goToDate(new Date().getTime());
  }
  else if (key === "1") {
    sunCenter=!sunCenter;
  }
  else if (key === "b") {
    extrude=!extrude;
  }
  else if (key === "t") {
    trails=!trails;
  }
  else if (key === "p") {
    onPreset++;
    if(onPreset>=presets.length){onPreset=0;}
    applyPreset();
  }
  else if (key === "`") {
    stats=!stats;
  }
  else if (keyCode === LEFT_ARROW) {
    speed*=-1;
  }
  else if (keyCode === UP_ARROW) {
    scle*=1.5;
    bubble/=1.5;
  }
  else if (keyCode === DOWN_ARROW) {
    scle/=1.5;
    bubble*=1.5;
  }
  holding[0][key]=true;
  holding[1][keyCode]=true;
}
/*
function touchBodyted () {
  var fs = fullscreen();
  if (!fs) {
    fullscreen(true);
  }
}

/* full screening will change the size of the canvas */
function windowResized() {
  resizeCanvas(windowWidth, windowHeight);
  w=width;
  h=height;
}

/* prevents the mobile browser from processing some default
 * touch events, like swiping left for "back" or scrolling
 * the page.
 */
document.ontouchmove = function(event) {
    event.preventDefault();
}
/*cool*/
